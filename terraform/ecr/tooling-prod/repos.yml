default_read_template: &all_write_template
  ecr_repo_tag_mutability: "MUTABLE"
  tags:
    gitlab_production_build-pool: "write"
    gitlab_production_test-pool: "read"

# Disallow any write access from gitlab processes, including runners.
readonly_template: &readonly_template
  ecr_repo_tag_mutability: "MUTABLE"
  tags: {}

# If you add an existing repo, you may need to import the state, e.g.
# tf-deploy ecr/tooling import 'module.repos["gitlab-qa"].aws_ecr_repository.ecr_repo' gitlab-qa
    
repos:
  alpine:
    name: "ecr-public/docker/library/alpine"
    <<: *all_write_template
  env_deploy:
    name: "cd/env_deploy"
    <<: *all_write_template
  env_stop:
    name: "cd/env_stop"
    <<: *all_write_template
  env_test:
    name: "cd/env_test"
    <<: *all_write_template
  env_deploy_blessed:
    name: "cd/env_deploy/blessed"
    <<: *readonly_template
  env_stop_blessed:
    name: "cd/env_stop/blessed"
    <<: *readonly_template
  env_test_blessed:
    name: "cd/env_test/blessed"
    <<: *readonly_template
  gitlab_deploy:
    name: "cd/gitlab_deploy"
    <<: *all_write_template
  gitlab_test:
    name: "cd/gitlab_test"
    <<: *all_write_template
  gitlab_deploy_blessed:
    name: "cd/gitlab_deploy/blessed"
    <<: *readonly_template
  gitlab_test_blessed:
    name: "cd/gitlab_test/blessed"
    <<: *readonly_template
  golang:
    name: "ecr-public/docker/library/golang"
    <<: *all_write_template
  idp_ci:
    name: "idp/ci"
    <<: *all_write_template
  postgres:
    name: "ecr-public/docker/library/postgres"
    <<: *all_write_template
  redis:
    name: "ecr-public/docker/library/redis"
    <<: *all_write_template
  ruby:
    name: "ecr-public/docker/library/ruby"
    <<: *all_write_template
  tf_deploy:
    name: "cd/tf_deploy"
    <<: *all_write_template
  identity_idp_review:
    name: "identity-idp/review"
    <<: *all_write_template
  identity_idp_review_cache:
    name: "identity-idp/review/cache"
    <<: *all_write_template
  identity_pivcac_review:
    name: "identity-pivcac/review"
    <<: *all_write_template
  identity_pivcac_review_cache:
    name: "identity-pivcac/review/cache"
    <<: *all_write_template
  gitlab_dast:
    name: "gitlab/dast"
    <<: *all_write_template
