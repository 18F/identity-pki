# Service Discovery

A cookbook whose purpose is to abstract service discovery.

## Core Discovery Library

This is the heart of this cookbook, on which everything else is based.  In most
cases you should not need to use this directly, unless you specifically need to
use a list of instances in a recipe or resource.  Be careful with chef's [two
pass model](https://coderanger.net/two-pass/), which you have to think about if
you're using a library directly.

├── libraries
│   └── service_discovery.rb

## Register Instance

This recipe registers the instance and uploads the default certificate
(generated by our certificate generation cookbook) if it exists at the
configured path.

├── recipes
│   ├── register.rb

## Certificate Management

These resources allow publishing of custom certificates and downloading
certificates into a specific directory.  This is useful if you want to trust
certificates from a specific set of nodes.

├── resources
│   ├── install_certificates.rb
│   └── publish_certificate.rb

## Boilerplate

Boilerplate and test structure for the cookbook.  See the [cookbook
structure](https://github.com/18F/identity-devops/tree/main/doc/technical/cookbook-structure.md)
documentation.

├── Berksfile
├── chefignore
├── Gemfile
├── environments
│   └── ci.json
└── test
    └── smoke
        └── default
            └── install_certificates_test.rb
    .kitchen.yml
├── attributes
│   └── default.rb
├── metadata.rb
├── README.md
├── recipes
│   ├── test_install_certificates.rb
│   └── test_publish_certificate.rb
