input {
  cloudwatch_logs {
    log_group => "<%= @env %>_flow_log_group"
    region => "<%= @aws_region %>"
    type => "flowlog"
    sincedb_path => "/usr/share/logstash/.sincedb_cloudwatch"
    start_position => "end"
  }
}

filter {
  grok {
    match => { "message" => "%{NUMBER:version} %{NUMBER:account-id} %{NOTSPACE:interface-id} %{NOTSPACE:srcaddr} %{NOTSPACE:dstaddr} %{NOTSPACE:srcport} %{NOTSPACE:dstport} %{NOTSPACE:protocol} %{NOTSPACE:packets} %{NOTSPACE:bytes} %{NUMBER:start} %{NUMBER:end} %{NOTSPACE:action} %{NOTSPACE:log-status}" }
  }
}

