<%
elk_passwords = Chef::Recipe::ConfigLoader.load_json(node, 'elk_htpasswd.json', common: true)
@users.each do |username|
  begin
  %> <%= "#{username}:#{elk_passwords.fetch(username)}" %>
<%
  rescue KeyError
    Chef::Log.error("Couldn't find elk password hash for #{username.inspect}")
    Chef::Log.error("Create one with `htpasswd -nB -C 10 <username>`")
    Chef::Log.error("Then add it to S3 secrets inside /common/elk_htpasswd.json")
    raise
  end
end
%>
