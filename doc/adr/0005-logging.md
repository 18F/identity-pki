# Architecture Decision Record 5: Log Storage and Search

> Login.gov uses AWS CloudWatch Logs as our central logging source of truth
> with CloudWatch Logs Insights for search and related CloudWatch tools for
> analysis.

__Status__: implemented

## Context

Login.gov must store all logs generated by applications and supporting infrastructure.
This includes OS, application, AWS CloudTrail, WAF, and other logs that may be
useful in audit or troubleshooting of systems.

Login.gov must retain logs for up to 6 years, and can not risk losing user activity
data.

Logs must be easy to search and easy to export elsewhere, as done for our
GSA Security Operations Center engagement.

AWS CloudWatch Logs is a FedRAMP Moderate service with reasonable pricing and functionality.
While not the original logging target for the program, (that being ElasticSearch),
it has proven highly reliable and usable enough to meet current needs.

## Decision

_We will use **AWS CloudWatch Logs** as our authoritative logging destination._

## Consequences

* Less operational overhead to manage/authorize
* Less context overhead for developers and other data users - Only one system to learn
* Relatively low cost
* Teams have been able to develop and iterate on complex dashboards, metrics, and
  alerts

## Alternatives Considered

ElasticSearch (either from ElasticSearch or AWS OpenSearch) provides
superior search experience at the cost of added operational overhead.  The
original Login.gov source of truth for logs was ElasticSearch.  We [decomissioned
our home grown ElasticSearch solution in early 2021 due to overhead and redundancy](https://docs.google.com/document/d/12q3YRWQzi-FVxok-7e2v5gk91j7G7QsM5vuw5M8aFQM/edit).
The SOCaaS engagement will provide ElasticSearch/Kibana access without the
overhead.

AWS Athena with S3 as a data source provides SQL-like querying of logs.  Its
ad-hoc style and complexity make it unsuitable for regular use.

AWS RedShift is a "big data" solution allowing easy querying of massive amounts
of data.  Login.gov [had a data pipeline delivering log data to RedShift](https://docs.google.com/document/d/1Ke1yZ3g4sHfAqPq0sCqnsNYZztKsz5lgGp4mGy_XTb0/edit).
[This was decomissioned due to lack of use and high cost](https://github.com/18F/identity-devops/issues/2715).
It can be spun back up if the program decides it is needed again.
